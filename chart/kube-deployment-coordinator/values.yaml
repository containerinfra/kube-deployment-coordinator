# Default values for the kube-deployment-coordinator.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.
image:
# image used to deploy the kube-deployment-coordinator
  repository: ghcr.io/containerinfra/kube-deployment-coordinator
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion.
  tag: 

# This section specifies the Kubernetes secret that is required to pull the image from the private container registry.
imagePullSecrets: {}

# The "nameOverride" value allows you to override the default name used when installing the Helm chart.
# By default, the Helm release name is derived from the name provided during the installation process.
# If "nameOverride" is not specified or left empty, the Helm release name remains the same as the one
# provided during installation.
nameOverride: ""
# The "fullnameOverride" value makes it possible to customize the full name of the Helm release, which includes the release name
# and the chart name.
fullnameOverride: ""

extraArgs: []
envFrom: []

# Metrics and health probe ports
# These ports are used for container ports and to construct bind addresses (format: ":PORT")
metricsPort: 7712
healthPort: 7713

replicaCount: 1
minAvailable: 1
enablePodDisruptionBudget: false

service:
  type: ClusterIP

serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

# Pod Annotations for API and API Daemon
# Use the following annotations to apply metadata and configuration to the pods of the API and the API daemon.
podAnnotations: {}

podSecurityContext:
  seccompProfile:
    type: RuntimeDefault
  runAsNonRoot: true
  runAsGroup: 65532
  runAsUser: 65532
  fsGroup: 65532

securityContext:
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: true
  capabilities:
    drop: ['ALL']
  runAsUser: 65532

resources: {}
  # We usually recommend not to specify default resources and to leave this as a conscious
  # choice for the user. This also increases chances charts run on environments with little
  # resources, such as Minikube. If you do want to specify resources, uncomment the following
  # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
  # limits:
  #   cpu: 100m
  #   memory: 128Mi
  # requests:
  #   cpu: 100m
  #   memory: 128Mi

# Use the following settings to configure node affinity, tolerations, and affinity rules for the API and the API daemon
# Define node labels as key-value pairs to select specific nodes for running the pods of the API and the API daemon.
# When specified, the pods will be scheduled only on the nodes that match the specified labels.
nodeSelector: {}

tolerations: []

affinity: {}

# enable or disable the deployment of the Service monitor
enableServiceMonitor: true

leaderElection:
  enabled: false
  # id: kube-deployment-coordinator.containerinfra.nl

livenessProbe:
  httpGet:
    path: /healthz
    port: health
  initialDelaySeconds: 10
  periodSeconds: 10
  timeoutSeconds: 10
  failureThreshold: 3

readinessProbe:
  httpGet:
    path: /readyz
    port: health
  initialDelaySeconds: 10
  periodSeconds: 10
  timeoutSeconds: 10
  failureThreshold: 3

# Webhook configuration
webhook:
  # Enable or disable the mutating webhook
  enabled: true
  # Name of the MutatingWebhookConfiguration resource
  name: ""
  # Name of the webhook (used in the webhook configuration)
  webhookName: kube-deployment-coordinator.containerinfra.nl
  # Name of the webhook service
  serviceName: webhook-service
  # Path for the webhook endpoint
  path: /mutate-apps-v1-deployment
  # Operations to intercept (CREATE, UPDATE)
  operations:
    - CREATE
    - UPDATE
  # Admission review versions
  admissionReviewVersions:
    - v1
  # Side effects of the webhook
  sideEffects: None
  # Failure policy (Ignore or Fail)
  failurePolicy: Ignore
  # CA bundle for the webhook (if using cert-manager, this will be injected automatically)
  # Only used if certManager.enabled is false
  caBundle: ""
  # Cert-manager configuration for webhook certificates
  certManager:
    # Enable cert-manager for webhook certificates
    enabled: false
    # Create a self-signed issuer (set to false if using an existing issuer)
    createIssuer: true
    # Name of the issuer to use (only used if createIssuer is false)
    issuerName: selfsigned-issuer
    # Custom issuer reference (overrides issuerName if set)
    # issuerRef:
    #   kind: ClusterIssuer
    #   name: letsencrypt-prod
    # Name of the Certificate resource
    certificateName: webhook-serving-cert
    # Name of the secret where certificates will be stored
    secretName: webhook-server-cert
    # Additional DNS names for the certificate (optional)
    # dnsNames: []
  # Annotations to add to the MutatingWebhookConfiguration
  annotations: {}
  # Namespace selector for the webhook (optional)
  namespaceSelector: {}
  # Object selector for the webhook (optional)
  objectSelector: {}
